WN10-SO-000080 – The Windows Dialog Box Title for the Legal Banner Must Be Configured
Overview

Windows can display a legal notice before logon. This control requires both the title (caption) and the body text of the legal banner to be configured. Without them, users may not be clearly informed that the system is for authorized use only.

STIG Requirement

WN10-SO-000080: The Windows dialog box title for the legal banner must be configured.
(Often paired with WN10-SO-000085 – LegalNoticeText must be configured.)

Severity: Medium

Discussion: Legal banners help establish user awareness and legal standing for monitoring. Both a title and body text are required to provide clarity and enforce organizational requirements.

Fix Text

Configure the policy:

Navigate in Group Policy:
Computer Configuration > Windows Settings > Security Settings > Local Policies > Security Options > Interactive logon: Message title for users attempting to log on
Computer Configuration > Windows Settings > Security Settings > Local Policies > Security Options > Interactive logon: Message text for users attempting to log on

Set both values to non-empty strings (e.g., “NOTICE – Authorized Use Only” and “This system is for authorized use only. Unauthorized access is prohibited.”).

Registry equivalents:

Key:   HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
Values:
  LegalNoticeCaption (REG_SZ) = <custom title string>
  LegalNoticeText    (REG_SZ) = <custom body string>

Manual Registry Fix
# Set legal notice title and text
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /t REG_SZ /d "NOTICE - Authorized Use Only" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /t REG_SZ /d "This system is for authorized use only. Unauthorized access is prohibited." /f

# Verify
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText


Rollback (removes both values – not recommended):

reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /f

PowerShell Script (Check / Remediate / Rollback)

Save as Set-WN10-SO-000080.ps1

______________________________________________________________

<#
.SYNOPSIS
  Enforce DISA STIG WN10-SO-000080 (The Windows dialog box title for the legal banner must be configured).

.DESCRIPTION
  Ensures LegalNoticeCaption and LegalNoticeText are configured under
  HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System.
  Creates a backup before changes for rollback.

.NOTES
  Author          : Peter Kure
  LinkedIn        : linkedin.com/in/peter-kure
  Github          : github.com/pkure
  Date Created    : 8/28/2025
  Last Modified   : 8/28/2025
  Version         : 2.0
  CVEs            : n/a
  Plugin IDs      : n/a
  STIG-ID         : WN10-SO-000080 (+ WN10-SO-000085)

.PARAMETER Action
  "Check"     - Display current settings
  "Remediate" - Apply STIG-compliant values
  "Rollback"  - Restore from backup if available

.EXAMPLE
  .\Set-WN10-SO-000080.ps1 -Action Check
#>

param(
    [Parameter(Mandatory=$true)]
    [ValidateSet("Check","Remediate","Rollback")]
    [string]$Action,

    [string]$BannerTitle = "NOTICE - Authorized Use Only",
    [string]$BannerText  = "This system is for authorized use only. Unauthorized access is prohibited."
)

$RegPath   = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System"
$BackupKey = "HKLM:\SOFTWARE\LogNPacific\STIGBackups\WN10-SO-000080"

switch ($Action) {
    "Check" {
        $caption = Get-ItemProperty -Path $RegPath -Name "LegalNoticeCaption" -ErrorAction SilentlyContinue
        $text    = Get-ItemProperty -Path $RegPath -Name "LegalNoticeText" -ErrorAction SilentlyContinue

        if ($null -eq $caption) {
            Write-Output "LegalNoticeCaption not set."
        } else {
            Write-Output "LegalNoticeCaption is currently: $($caption.LegalNoticeCaption)"
        }

        if ($null -eq $text) {
            Write-Output "LegalNoticeText not set."
        } else {
            Write-Output "LegalNoticeText is currently: $($text.LegalNoticeText)"
        }
    }

    "Remediate" {
        foreach ($val in @("LegalNoticeCaption","LegalNoticeText")) {
            $current = Get-ItemProperty -Path $RegPath -Name $val -ErrorAction SilentlyContinue
            if ($current) {
                New-Item -Path $BackupKey -Force | Out-Null
                New-ItemProperty -Path $BackupKey -Name $val -Value $current.$val -PropertyType String -Force | Out-Null
                Write-Output "Backup saved: $BackupKey\$val = $($current.$val)"
            }
        }

        New-ItemProperty -Path $RegPath -Name "LegalNoticeCaption" -Value $BannerTitle -PropertyType String -Force | Out-Null
        Write-Output "Remediation applied: LegalNoticeCaption set to '$BannerTitle'"

        New-ItemProperty -Path $RegPath -Name "LegalNoticeText" -Value $BannerText -PropertyType String -Force | Out-Null
        Write-Output "Remediation applied: LegalNoticeText set to '$BannerText'"
    }

    "Rollback" {
        foreach ($val in @("LegalNoticeCaption","LegalNoticeText")) {
            $backup = Get-ItemProperty -Path $BackupKey -Name $val -ErrorAction SilentlyContinue
            if ($backup) {
                New-ItemProperty -Path $RegPath -Name $val -Value $backup.$val -PropertyType String -Force | Out-Null
                Write-Output "Rolled back: $val restored to '$($backup.$val)'"
            } else {
                Write-Output "No backup found for $val rollback."
            }
        }
    }
}

______________________________________________________________


Example Usage

Check current settings

.\Set-WN10-SO-000080.ps1 -Action Check


Remediate (apply default title & text)

.\Set-WN10-SO-000080.ps1 -Action Remediate


Remediate with custom text

.\Set-WN10-SO-000080.ps1 -Action Remediate -BannerTitle "ACME Corp – Authorized Access Only" -BannerText "This system is monitored. Unauthorized use is prohibited."


Rollback

.\Set-WN10-SO-000080.ps1 -Action Rollback

One-Liner PowerShell Commands

Check

reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText


Remediate

reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /t REG_SZ /d "NOTICE - Authorized Use Only" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /t REG_SZ /d "This system is for authorized use only. Unauthorized access is prohibited." /f


Rollback

reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /f
