WN10-SO-000080 – The Windows Dialog Box Title for the Legal Banner Must Be Configured
Overview

Windows displays a legal notice before logon. This STIG requires the title (caption) of the banner to be configured with approved wording, typically “DoD Notice and Consent Banner”, “US Department of Defense Warning Statement”, or an organizational equivalent.

STIG Requirement

WN10-SO-000080: The Windows dialog box title for the legal banner must be configured.

Severity: Medium

Discussion: Legal banners provide notice of monitoring and authorized use. Without a configured caption, users may not clearly understand system restrictions. DISA requires either the official DoD wording or an equivalent that does not weaken the mandatory text in WN10-SO-000075 (banner body).

Fix Text

Configure the policy:

Navigate in Group Policy:
Computer Configuration > Windows Settings > Security Settings > Local Policies > Security Options > Interactive logon: Message title for users attempting to log on

Set to: "DoD Notice and Consent Banner" (recommended).

Registry equivalents:

Key:   HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System  
Values:  
  LegalNoticeCaption (REG_SZ) = "DoD Notice and Consent Banner"  
  LegalNoticeText    (REG_SZ) = <custom body string, per WN10-SO-000075>  

Manual Registry Fix
# Set legal banner title and text
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /t REG_SZ /d "DoD Notice and Consent Banner" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /t REG_SZ /d "You are accessing a U.S. Government (USG) Information System (IS). Unauthorized use is prohibited..." /f

# Verify
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText


Rollback (removes both – not recommended):

reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /f

PowerShell Script (Check / Remediate / Rollback)

Save as Set-WN10-SO-000080.ps1


_______________________________________________________

<#
.SYNOPSIS
  Enforce DISA STIG WN10-SO-000080 (The Windows dialog box title for the legal banner must be configured).

.DESCRIPTION
  Ensures LegalNoticeCaption and LegalNoticeText are set under
  HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System.
  Caption defaults to "DoD Notice and Consent Banner".
  Creates a backup before changes for rollback.

.NOTES
  Author          : Peter Kure
  LinkedIn        : linkedin.com/in/peter-kure
  Github          : github.com/pkure
  Date Created    : 8/26/2025
  Last Modified   : 8/26/2025
  Version         : 3.0
  CVEs            : n/a
  Plugin IDs      : n/a
  STIG-ID         : WN10-SO-000080 (+ WN10-SO-000085)

.PARAMETER Action
  "Check"     - Display current settings
  "Remediate" - Apply STIG-compliant values
  "Rollback"  - Restore from backup if available

.PARAMETER BannerTitle
  Banner caption. Default: "DoD Notice and Consent Banner"

.PARAMETER BannerText
  Banner body text. Default: sample DoD notice

.EXAMPLE
  .\Set-WN10-SO-000080.ps1 -Action Remediate
#>

param(
    [Parameter(Mandatory=$true)]
    [ValidateSet("Check","Remediate","Rollback")]
    [string]$Action,

    [string]$BannerTitle = "DoD Notice and Consent Banner",
    [string]$BannerText  = "You are accessing a U.S. Government (USG) Information System (IS). Unauthorized use is prohibited."
)

$RegPath   = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System"
$BackupKey = "HKLM:\SOFTWARE\LogNPacific\STIGBackups\WN10-SO-000080"

switch ($Action) {
    "Check" {
        $caption = Get-ItemProperty -Path $RegPath -Name "LegalNoticeCaption" -ErrorAction SilentlyContinue
        $text    = Get-ItemProperty -Path $RegPath -Name "LegalNoticeText" -ErrorAction SilentlyContinue

        Write-Output ("LegalNoticeCaption: " + ($caption.LegalNoticeCaption  | Out-String).Trim())
        Write-Output ("LegalNoticeText: "    + ($text.LegalNoticeText       | Out-String).Trim())
    }

    "Remediate" {
        foreach ($val in @{"LegalNoticeCaption"=$BannerTitle;"LegalNoticeText"=$BannerText}.GetEnumerator()) {
            $current = Get-ItemProperty -Path $RegPath -Name $val.Key -ErrorAction SilentlyContinue
            if ($current) {
                New-Item -Path $BackupKey -Force | Out-Null
                New-ItemProperty -Path $BackupKey -Name $val.Key -Value $current.$($val.Key) -PropertyType String -Force | Out-Null
                Write-Output "Backup saved: $BackupKey\$($val.Key) = $($current.$($val.Key))"
            }
            New-ItemProperty -Path $RegPath -Name $val.Key -Value $val.Value -PropertyType String -Force | Out-Null
            Write-Output "Remediation applied: $($val.Key) set to '$($val.Value)'"
        }
    }

    "Rollback" {
        foreach ($val in @("LegalNoticeCaption","LegalNoticeText")) {
            $backup = Get-ItemProperty -Path $BackupKey -Name $val -ErrorAction SilentlyContinue
            if ($backup) {
                New-ItemProperty -Path $RegPath -Name $val -Value $backup.$val -PropertyType String -Force | Out-Null
                Write-Output "Rolled back: $val restored to '$($backup.$val)'"
            } else {
                Write-Output "No backup found for $val rollback."
            }
        }
    }
}


_______________________________________________________


Example Usage

Check current settings

.\Set-WN10-SO-000080.ps1 -Action Check


Remediate (DoD caption + default text)

.\Set-WN10-SO-000080.ps1 -Action Remediate


Remediate with custom text

.\Set-WN10-SO-000080.ps1 -Action Remediate -BannerTitle "DoD Notice and Consent Banner" -BannerText "This system is monitored. Unauthorized use is prohibited."


Rollback

.\Set-WN10-SO-000080.ps1 -Action Rollback

One-Liner PowerShell Commands

Check

reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption
reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText


Remediate

reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /t REG_SZ /d "DoD Notice and Consent Banner" /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /t REG_SZ /d "You are accessing a U.S. Government (USG) Information System (IS). Unauthorized use is prohibited." /f


Rollback

reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeCaption /f
reg delete "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" /v LegalNoticeText /f
