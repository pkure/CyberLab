WN10-CC-000197 – Microsoft Consumer Experiences Must Be Turned Off
Overview

Windows 10 includes “Microsoft consumer experiences,” which push apps, content, and advertisements to end users. In managed or enterprise environments, these are unnecessary and introduce potential distractions or vulnerabilities. This STIG requires the feature to be turned off.

STIG Requirement

WN10-CC-000197: Microsoft consumer experiences must be turned off.

Severity: Medium

Discussion: Consumer experiences deliver Microsoft-curated apps and services, some of which may not be approved for enterprise use. Disabling them ensures users are not exposed to unapproved software or advertisements that may reduce security posture.

Fix Text

Configure the policy:

Navigate in Group Policy:
Computer Configuration > Administrative Templates > Windows Components > Cloud Content > Turn off Microsoft consumer experiences

Set to: Enabled

Registry equivalents (Nessus checks these):

Key:   HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent
Values:
  DisableConsumerFeatures (DWORD)   = 1
  DisableWindowsConsumerFeatures    = 1
  DisableSoftLanding                = 1   (on newer builds)

Manual Registry Fix
# Disable consumer experiences
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableConsumerFeatures /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableSoftLanding /t REG_DWORD /d 1 /f

# Verify
reg query "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent"


Rollback (not recommended – re-enables consumer features):

reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableConsumerFeatures /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableSoftLanding /t REG_DWORD /d 0 /f

PowerShell Script (Check / Remediate / Rollback)

Save as Set-WN10-CC-000197.ps1

________________________________________________________


<#
.SYNOPSIS
  Enforce DISA STIG WN10-CC-000197 (Microsoft consumer experiences must be turned off).

.DESCRIPTION
  Ensures DisableConsumerFeatures, DisableWindowsConsumerFeatures, and DisableSoftLanding
  are all set to 1 under HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent.
  Creates a backup before changes for rollback.

.NOTES
  Author          : Peter Kure
  LinkedIn        : linkedin.com/in/peter-kure
  Github          : github.com/pkure
  Date Created    : 8/28/2025
  Last Modified   : 8/28/2025
  Version         : 2.0
  CVEs            : n/a
  Plugin IDs      : n/a
  STIG-ID         : WN10-CC-000197

.PARAMETER Action
  "Check"     - Display current settings
  "Remediate" - Apply STIG-compliant values
  "Rollback"  - Restore from backup if available

.EXAMPLE
  .\Set-WN10-CC-000197.ps1 -Action Check
#>

param(
    [Parameter(Mandatory=$true)]
    [ValidateSet("Check","Remediate","Rollback")]
    [string]$Action
)

$RegPath   = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent"
$ParentKey = "HKLM:\SOFTWARE\Policies\Microsoft\Windows"
$Values    = @("DisableConsumerFeatures","DisableWindowsConsumerFeatures","DisableSoftLanding")
$BackupKey = "HKLM:\SOFTWARE\LogNPacific\STIGBackups\WN10-CC-000197"

switch ($Action) {
    "Check" {
        foreach ($val in $Values) {
            $current = Get-ItemProperty -Path $RegPath -Name $val -ErrorAction SilentlyContinue
            if ($null -eq $current) {
                Write-Output "$val not set. Default may be insecure."
            } else {
                Write-Output "$val is set to $($current.$val)"
            }
        }
    }

    "Remediate" {
        # Ensure key exists
        if (-not (Test-Path $RegPath)) {
            New-Item -Path $ParentKey -Name "CloudContent" -Force | Out-Null
        }

        foreach ($val in $Values) {
            # Backup if present
            $current = Get-ItemProperty -Path $RegPath -Name $val -ErrorAction SilentlyContinue
            if ($current) {
                New-Item -Path $BackupKey -Force | Out-Null
                New-ItemProperty -Path $BackupKey -Name $val -Value $current.$val -PropertyType DWORD -Force | Out-Null
                Write-Output "Backup saved: $BackupKey\$val = $($current.$val)"
            }
            # Apply compliant value
            New-ItemProperty -Path $RegPath -Name $val -Value 1 -PropertyType DWORD -Force | Out-Null
            Write-Output "Remediation applied: $val set to 1"
        }
    }

    "Rollback" {
        if (-not (Test-Path $RegPath)) {
            New-Item -Path $ParentKey -Name "CloudContent" -Force | Out-Null
        }

        foreach ($val in $Values) {
            $backup = Get-ItemProperty -Path $BackupKey -Name $val -ErrorAction SilentlyContinue
            if ($backup) {
                New-ItemProperty -Path $RegPath -Name $val -Value $backup.$val -PropertyType DWORD -Force | Out-Null
                Write-Output "Rolled back: $val restored to $($backup.$val)"
            } else {
                Write-Output "No backup found for $val rollback."
            }
        }
    }
}


________________________________________________________

Example Usage

Check current settings

.\Set-WN10-CC-000197.ps1 -Action Check


Remediate (disable all consumer features)

.\Set-WN10-CC-000197.ps1 -Action Remediate


Rollback

.\Set-WN10-CC-000197.ps1 -Action Rollback

One-Liner PowerShell Commands

Check

reg query "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent"


Remediate

reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableConsumerFeatures /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableSoftLanding /t REG_DWORD /d 1 /f


Rollback

reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableConsumerFeatures /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableWindowsConsumerFeatures /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\CloudContent" /v DisableSoftLanding /t REG_DWORD /d 0 /f
