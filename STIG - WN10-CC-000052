WN10-CC-000052 – Windows 10 Must Prioritize ECC Curves with Longer Key Lengths
Overview

TLS settings in Windows allow administrators to define which Elliptic Curve Cryptography (ECC) curves are used for key exchange. To maximize security, systems must prioritize stronger curves (e.g., NistP384) ahead of weaker ones (e.g., NistP256).

STIG Requirement

WN10-CC-000052: Windows 10 must be configured to prioritize ECC Curves with longer key lengths first.

Severity: Medium

Discussion: ECC provides strong cryptographic protection with smaller key sizes compared to RSA. Prioritizing P-384 over P-256 increases resistance to attacks.

Fix Text

Configure the policy:

Navigate in Group Policy:
Computer Configuration > Administrative Templates > Network > SSL Configuration Settings > ECC Curve Order

Set to: Enabled and specify the following string:

NistP384,NistP256


Registry equivalent:

Key:   HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002  
Value: EccCurves (REG_SZ)  
Data:  NistP384,NistP256  

Manual Registry Fix
# Apply ECC curve order
reg add "HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002" /v EccCurves /t REG_SZ /d "NistP384,NistP256" /f

# Verify
reg query "HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002" /v EccCurves


Rollback (delete value → revert to system default order):

reg delete "HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002" /v EccCurves /f

PowerShell Script (Check / Remediate / Rollback)

Save as Set-WN10-CC-000052.ps1


_________________________________________________________________


<#
.SYNOPSIS
  Enforce DISA STIG WN10-CC-000052 (Prioritize ECC curves with longer key lengths first).

.DESCRIPTION
  Ensures the ECC Curve Order registry value is set to "NistP384,NistP256"
  under HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002.
  Creates a backup before changes for rollback.

.NOTES
  Author          : Peter Kure
  LinkedIn        : linkedin.com/in/peter-kure
  Github          : github.com/pkure
  Date Created    : 8/26/2025
  Last Modified   : 8/26/2025
  Version         : 3.0
  CVEs            : n/a
  Plugin IDs      : n/a
  STIG-ID         : WN10-CC-000052

.PARAMETER Action
  "Check"     - Display current EccCurves string
  "Remediate" - Apply STIG-compliant ECC order
  "Rollback"  - Restore from backup if available

.EXAMPLE
  .\Set-WN10-CC-000052.ps1 -Action Check
#>

param(
    [Parameter(Mandatory=$true)]
    [ValidateSet("Check","Remediate","Rollback")]
    [string]$Action
)

$RegPath   = "HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002"
$Value     = "EccCurves"
$BackupKey = "HKLM:\SOFTWARE\LogNPacific\STIGBackups\WN10-CC-000052"

# Required STIG value
$CompliantValue = "NistP384,NistP256"

switch ($Action) {
    "Check" {
        $current = Get-ItemProperty -Path $RegPath -Name $Value -ErrorAction SilentlyContinue
        if ($null -eq $current) {
            Write-Output "EccCurves not set. Default may be insecure."
        } else {
            Write-Output "EccCurves is currently set to: $($current.$Value)"
        }
    }

    "Remediate" {
        $current = Get-ItemProperty -Path $RegPath -Name $Value -ErrorAction SilentlyContinue
        if ($current) {
            New-Item -Path $BackupKey -Force | Out-Null
            New-ItemProperty -Path $BackupKey -Name $Value -Value $current.$Value -PropertyType String -Force | Out-Null
            Write-Output "Backup saved: $BackupKey\$Value = $($current.$Value)"
        }
        New-ItemProperty -Path $RegPath -Name $Value -Value $CompliantValue -PropertyType String -Force | Out-Null
        Write-Output "Remediation applied: EccCurves set to $CompliantValue"
    }

    "Rollback" {
        $backup = Get-ItemProperty -Path $BackupKey -Name $Value -ErrorAction SilentlyContinue
        if ($backup) {
            New-ItemProperty -Path $RegPath -Name $Value -Value $backup.$Value -PropertyType String -Force | Out-Null
            Write-Output "Rolled back: EccCurves restored to $($backup.$Value)"
        } else {
            Write-Output "No backup found for rollback."
        }
    }
}


_________________________________________________________________



Example Usage

Check current setting

.\Set-WN10-CC-000052.ps1 -Action Check


Remediate (apply ECC curve order)

.\Set-WN10-CC-000052.ps1 -Action Remediate


Rollback

.\Set-WN10-CC-000052.ps1 -Action Rollback
