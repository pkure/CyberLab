WN10-CC-000052 – Windows 10 Must Prioritize ECC Curves with Longer Key Lengths
Overview

TLS cipher suites determine how Windows negotiates secure communications. STIG requires the cipher suite order string to prioritize ECC curves with longer key lengths first (e.g., P-384, P-521 ahead of P-256).

STIG Requirement

WN10-CC-000052: Windows 10 must be configured to prioritize ECC Curves with longer key lengths first.

Severity: Medium

Discussion: ECC with longer key lengths (P-384, P-521) provides stronger protection than shorter curves (P-256). By configuring the SSL Cipher Suite Order, Windows will attempt stronger ciphers first during TLS negotiations.

Fix Text

Configure the policy:

Navigate in Group Policy:
Computer Configuration > Administrative Templates > Network > SSL Configuration Settings > SSL Cipher Suite Order

Set to: Enabled and paste the compliant cipher suite string (DISA/Microsoft baseline).

Registry equivalent:

Key:   HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002
Value: Functions (REG_SZ)
Data:  <full cipher suite order string>

Manual Registry Fix
# Apply Microsoft/DISA baseline cipher suite order (ECC first)
reg add "HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002" /v Functions /t REG_SZ /d "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384_P384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_P384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384_P256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_P256,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256" /f

# Verify
reg query "HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002" /v Functions


Rollback (remove custom order → revert to system defaults):

reg delete "HKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002" /v Functions /f

PowerShell Script (Check / Remediate / Rollback)

Save as Set-WN10-CC-000052.ps1



___________________________________________________________


<#
.SYNOPSIS
  Enforce DISA STIG WN10-CC-000052 (Prioritize ECC curves with longer key lengths first).

.DESCRIPTION
  Ensures the SSL Cipher Suite Order registry value is set to a compliant string
  with longer ECC curves prioritized before shorter curves.
  Creates a backup before changes for rollback.

.NOTES
  Author          : Peter Kure
  LinkedIn        : linkedin.com/in/peter-kure
  Github          : github.com/pkure
  Date Created    : 8/25/2025
  Last Modified   : 8/25/2025
  Version         : 2.0
  CVEs            : n/a
  Plugin IDs      : n/a
  STIG-ID         : WN10-CC-000052

.PARAMETER Action
  "Check"     - Display current Functions string
  "Remediate" - Apply STIG-compliant cipher suite string
  "Rollback"  - Restore from backup if available

.EXAMPLE
  .\Set-WN10-CC-000052.ps1 -Action Check
#>

param(
    [Parameter(Mandatory=$true)]
    [ValidateSet("Check","Remediate","Rollback")]
    [string]$Action
)

$RegPath   = "HKLM:\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002"
$Value     = "Functions"
$BackupKey = "HKLM:\SOFTWARE\LogNPacific\STIGBackups\WN10-CC-000052"

# Full ECC-first cipher suite string (from Microsoft baseline)
$CompliantValue = "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P384,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384_P384,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_P384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384_P256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384_P256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_P256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_P256,TLS_RSA_WITH_AES_256_GCM_SHA384,TLS_RSA_WITH_AES_128_GCM_SHA256"

switch ($Action) {
    "Check" {
        $current = Get-ItemProperty -Path $RegPath -Name $Value -ErrorAction SilentlyContinue
        if ($null -eq $current) {
            Write-Output "Functions not set. Default (possibly insecure) order may apply."
        } else {
            Write-Output "Functions is currently set to:"
            Write-Output $current.$Value
        }
    }

    "Remediate" {
        $current = Get-ItemProperty -Path $RegPath -Name $Value -ErrorAction SilentlyContinue
        if ($current) {
            New-Item -Path $BackupKey -Force | Out-Null
            New-ItemProperty -Path $BackupKey -Name $Value -Value $current.$Value -PropertyType String -Force | Out-Null
            Write-Output "Backup saved."
        }
        New-ItemProperty -Path $RegPath -Name $Value -Value $CompliantValue -PropertyType String -Force | Out-Null
        Write-Output "Remediation applied: Functions set to compliant ECC-first string"
    }

    "Rollback" {
        $backup = Get-ItemProperty -Path $BackupKey -Name $Value -ErrorAction SilentlyContinue
        if ($backup) {
            New-ItemProperty -Path $RegPath -Name $Value -Value $backup.$Value -PropertyType String -Force | Out-Null
            Write-Output "Rolled back: Functions restored from backup"
        } else {
            Write-Output "No backup found for rollback."
        }
    }
}


___________________________________________________________

Example Usage

Check current setting

.\Set-WN10-CC-000052.ps1 -Action Check


Remediate (apply ECC-first order)

.\Set-WN10-CC-000052.ps1 -Action Remediate


Rollback

.\Set-WN10-CC-000052.ps1 -Action Rollback
